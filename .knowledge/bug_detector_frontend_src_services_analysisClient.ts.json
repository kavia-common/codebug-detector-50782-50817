{"is_source_file": true, "format": "TypeScript", "description": "Source code for an analysis client module that provides interfaces and functions for analyzing code snippets for issues, including mock analysis and remote API calls, with internal utility functions for managing responses and errors.", "external_files": ["../config/config"], "external_methods": ["fetch", "crypto.randomUUID"], "published": ["analyze"], "classes": [], "methods": [{"name": "export async function analyze(snippet: string, language: string): Promise<AnalysisResponse> { analyze", "description": "Public function that analyzes a code snippet for potential bugs and issues, either by calling a remote API or providing a mock response in demo mode.", "scope": "", "scopeKind": ""}, {"name": "function cryptoLikeRandomId(): string { cryptoLikeRandomId", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "async function fetchWithTimeout(resource: string, options: RequestInit = {}, timeoutMs = 12000, / fetchWithTimeout", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function mapFinding(raw: Record<string, unknown>): AnalysisFinding { mapFinding", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function mapHttpErrorMessage(status: number): string { mapHttpErrorMessage", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function mockAnalyze(snippet: string, language: string): AnalysisResponse { mockAnalyze", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function normalizeResponse(payload: unknown): AnalysisResponse { normalizeResponse", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function processErrorDetails(err: unknown): unknown { processErrorDetails", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function safeParseTextAsJson(text: string): unknown { safeParseTextAsJson", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function summarize(findings: AnalysisFinding[]): AnalysisSummary { summarize", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["fetchWithTimeout", "normalizeResponse", "mapHttpErrorMessage", "safeParseTextAsJson", "processErrorDetails", "cryptoLikeRandomId", "summarize"], "search-terms": ["AnalysisClient", "analyze", "AnalysisResponse", "mockAnalyze", "fetchWithTimeout", "normalizeResponse", "Error Handling", "Severity", "AnalysisFinding"], "state": 2, "file_id": 8, "knowledge_revision": 24, "git_revision": "d2651be188fa2f3f3c4fce649f8680f7134162c2", "revision_history": [{"18": ""}, {"24": "d2651be188fa2f3f3c4fce649f8680f7134162c2"}], "ctags": [{"_type": "tag", "name": "AnalysisFinding", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^export interface AnalysisFinding {$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "AnalysisResponse", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^export interface AnalysisResponse {$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "AnalysisSummary", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^export interface AnalysisSummary {$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "FetchLike", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^type FetchLike = typeof fetch;$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "Severity", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^export type Severity = 'info' | 'low' | 'medium' | 'high' | 'critical';$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "analyze", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^export async function analyze(snippet: string, language: string): Promise<AnalysisResponse> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "anyErr", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^    const anyErr = err as { name?: unknown; message?: unknown; stack?: unknown };$/", "language": "TypeScript", "kind": "constant", "scope": "processErrorDetails", "scopeKind": "function"}, {"_type": "tag", "name": "apiBase", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  const { apiBase, isDemo } = appConfig;$/", "language": "TypeScript", "kind": "constant", "scope": "analyze", "scopeKind": "function"}, {"_type": "tag", "name": "base", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  const base: Record<Severity, number> = {$/", "language": "TypeScript", "kind": "constant", "scope": "summarize", "scopeKind": "function"}, {"_type": "tag", "name": "baseFindings", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  const baseFindings: AnalysisFinding[] = [];$/", "language": "TypeScript", "kind": "constant", "scope": "mockAnalyze", "scopeKind": "function"}, {"_type": "tag", "name": "baseFindings", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  const findings = baseFindings.length ? baseFindings : [$/", "language": "TypeScript", "kind": "constant", "scope": "mockAnalyze", "scopeKind": "function"}, {"_type": "tag", "name": "bySeverity", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  bySeverity: Record<Severity, number>;$/", "language": "TypeScript", "kind": "property", "scope": "AnalysisSummary", "scopeKind": "interface"}, {"_type": "tag", "name": "contentType", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^    const contentType = resp.headers.get('content-type') || '';$/", "language": "TypeScript", "kind": "constant", "scope": "analyze", "scopeKind": "function"}, {"_type": "tag", "name": "controller", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  const controller = new AbortController();$/", "language": "TypeScript", "kind": "constant", "scope": "fetchWithTimeout", "scopeKind": "function"}, {"_type": "tag", "name": "cryptoLikeRandomId", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^function cryptoLikeRandomId(): string {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^    const data: unknown = isJson ? await resp.json() : await safeParseTextAsJson(await resp.text/", "language": "TypeScript", "kind": "constant", "scope": "analyze", "scopeKind": "function"}, {"_type": "tag", "name": "description", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  description: string;$/", "language": "TypeScript", "kind": "property", "scope": "AnalysisFinding", "scopeKind": "interface"}, {"_type": "tag", "name": "error", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  error?: {$/", "language": "TypeScript", "kind": "property", "scope": "AnalysisResponse", "scopeKind": "interface"}, {"_type": "tag", "name": "f", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  for (const f of findings) {$/", "language": "TypeScript", "kind": "constant", "scope": "summarize", "scopeKind": "function"}, {"_type": "tag", "name": "fetchWithTimeout", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^async function fetchWithTimeout(resource: string, options: RequestInit = {}, timeoutMs = 12000, /", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "findings", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^    const findings = (payload as { findings: unknown[] }).findings.map(mapFinding);$/", "language": "TypeScript", "kind": "constant", "scope": "normalizeResponse", "scopeKind": "function"}, {"_type": "tag", "name": "findings", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  const findings = Array.isArray(rawFindings) ? rawFindings.map(mapFinding) : [];$/", "language": "TypeScript", "kind": "constant", "scope": "normalizeResponse", "scopeKind": "function"}, {"_type": "tag", "name": "findings", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  const findings = baseFindings.length ? baseFindings : [$/", "language": "TypeScript", "kind": "constant", "scope": "mockAnalyze", "scopeKind": "function"}, {"_type": "tag", "name": "findings", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  findings: AnalysisFinding[];$/", "language": "TypeScript", "kind": "property", "scope": "AnalysisResponse", "scopeKind": "interface"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  const id = setTimeout(() => controller.abort(), timeoutMs);$/", "language": "TypeScript", "kind": "constant", "scope": "fetchWithTimeout", "scopeKind": "function"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  id: string;$/", "language": "TypeScript", "kind": "property", "scope": "AnalysisFinding", "scopeKind": "interface"}, {"_type": "tag", "name": "isAbort", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^    const isAbort = err?.name === 'AbortError';$/", "language": "TypeScript", "kind": "constant", "scope": "analyze", "scopeKind": "function"}, {"_type": "tag", "name": "isDemo", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  const { apiBase, isDemo } = appConfig;$/", "language": "TypeScript", "kind": "constant", "scope": "analyze", "scopeKind": "function"}, {"_type": "tag", "name": "isJson", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^    const isJson = contentType.includes('application\\/json');$/", "language": "TypeScript", "kind": "constant", "scope": "analyze", "scopeKind": "function"}, {"_type": "tag", "name": "le", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  const le = Number(raw?.lineEnd ?? raw?.endLine ?? ls);$/", "language": "TypeScript", "kind": "constant", "scope": "mapFinding", "scopeKind": "function"}, {"_type": "tag", "name": "lineEnd", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  lineEnd: number;$/", "language": "TypeScript", "kind": "property", "scope": "AnalysisFinding", "scopeKind": "interface"}, {"_type": "tag", "name": "lineStart", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  lineStart: number;$/", "language": "TypeScript", "kind": "property", "scope": "AnalysisFinding", "scopeKind": "interface"}, {"_type": "tag", "name": "ls", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  const ls = Number(raw?.lineStart ?? raw?.line ?? 1);$/", "language": "TypeScript", "kind": "constant", "scope": "mapFinding", "scopeKind": "function"}, {"_type": "tag", "name": "mapFinding", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^function mapFinding(raw: Record<string, unknown>): AnalysisFinding {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "mapHttpErrorMessage", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^function mapHttpErrorMessage(status: number): string {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "message", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^    const anyErr = err as { name?: unknown; message?: unknown; stack?: unknown };$/", "language": "TypeScript", "kind": "constant", "scope": "processErrorDetails", "scopeKind": "function"}, {"_type": "tag", "name": "mockAnalyze", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^function mockAnalyze(snippet: string, language: string): AnalysisResponse {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "normalizeResponse", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^function normalizeResponse(payload: unknown): AnalysisResponse {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "p", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  const p = payload as Record<string, unknown>;$/", "language": "TypeScript", "kind": "constant", "scope": "normalizeResponse", "scopeKind": "function"}, {"_type": "tag", "name": "processErrorDetails", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^function processErrorDetails(err: unknown): unknown {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "rawFindings", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  const rawFindings = ((p?.issues as unknown) || (p?.results as unknown) || (p?.findings as unkn/", "language": "TypeScript", "kind": "constant", "scope": "normalizeResponse", "scopeKind": "function"}, {"_type": "tag", "name": "recommendation", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  recommendation: string;$/", "language": "TypeScript", "kind": "property", "scope": "AnalysisFinding", "scopeKind": "interface"}, {"_type": "tag", "name": "resp", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^    const resp = await _fetch(resource, { ...options, signal: controller.signal });$/", "language": "TypeScript", "kind": "constant", "scope": "fetchWithTimeout", "scopeKind": "function"}, {"_type": "tag", "name": "resp", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^    const resp = await fetchWithTimeout(url, {$/", "language": "TypeScript", "kind": "constant", "scope": "analyze", "scopeKind": "function"}, {"_type": "tag", "name": "rule", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  rule: string;$/", "language": "TypeScript", "kind": "property", "scope": "AnalysisFinding", "scopeKind": "interface"}, {"_type": "tag", "name": "safeParseTextAsJson", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^function safeParseTextAsJson(text: string): unknown {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "sev", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  const sev = (String(raw?.severity || raw?.level || 'info').toLowerCase() as Severity);$/", "language": "TypeScript", "kind": "constant", "scope": "mapFinding", "scopeKind": "function"}, {"_type": "tag", "name": "severity", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  const severity: Severity = valid.includes(sev) ? sev : 'info';$/", "language": "TypeScript", "kind": "constant", "scope": "mapFinding", "scopeKind": "function"}, {"_type": "tag", "name": "severity", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  severity: Severity;$/", "language": "TypeScript", "kind": "property", "scope": "AnalysisFinding", "scopeKind": "interface"}, {"_type": "tag", "name": "stack", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^    const anyErr = err as { name?: unknown; message?: unknown; stack?: unknown };$/", "language": "TypeScript", "kind": "constant", "scope": "processErrorDetails", "scopeKind": "function"}, {"_type": "tag", "name": "summarize", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^function summarize(findings: AnalysisFinding[]): AnalysisSummary {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "summary", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  summary: AnalysisSummary;$/", "language": "TypeScript", "kind": "property", "scope": "AnalysisResponse", "scopeKind": "interface"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^      title: 'No issues detected in mock mode',$/", "language": "TypeScript", "kind": "constant", "scope": "mockAnalyze", "scopeKind": "function"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  title: string;$/", "language": "TypeScript", "kind": "property", "scope": "AnalysisFinding", "scopeKind": "interface"}, {"_type": "tag", "name": "total", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  total: number;$/", "language": "TypeScript", "kind": "property", "scope": "AnalysisSummary", "scopeKind": "interface"}, {"_type": "tag", "name": "trimmed", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  const trimmed = (snippet || '').trim();$/", "language": "TypeScript", "kind": "constant", "scope": "mockAnalyze", "scopeKind": "function"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  const url = `${apiBase}\\/analyze`;$/", "language": "TypeScript", "kind": "constant", "scope": "analyze", "scopeKind": "function"}, {"_type": "tag", "name": "valid", "path": "/home/kavia/workspace/code-generation/codebug-detector-50782-50817/bug_detector_frontend/src/services/analysisClient.ts", "pattern": "/^  const valid: Severity[] = ['info', 'low', 'medium', 'high', 'critical'];$/", "language": "TypeScript", "kind": "constant", "scope": "mapFinding", "scopeKind": "function"}], "hash": "82569ecce4205bb642582d79ea34860a", "format-version": 4, "code-base-name": "bug_detector_frontend", "filename": "bug_detector_frontend/src/services/analysisClient.ts", "fields": [{"name": "export interface AnalysisFinding {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "export interface AnalysisResponse {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "export interface AnalysisSummary {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bySeverity: Record<Severity, number>;", "scope": "AnalysisSummary", "scopeKind": "interface", "description": "unavailable"}, {"name": "description: string;", "scope": "AnalysisFinding", "scopeKind": "interface", "description": "unavailable"}, {"name": "error?: {", "scope": "AnalysisResponse", "scopeKind": "interface", "description": "unavailable"}, {"name": "findings: AnalysisFinding[];", "scope": "AnalysisResponse", "scopeKind": "interface", "description": "unavailable"}, {"name": "id: string;", "scope": "AnalysisFinding", "scopeKind": "interface", "description": "unavailable"}, {"name": "lineEnd: number;", "scope": "AnalysisFinding", "scopeKind": "interface", "description": "unavailable"}, {"name": "lineStart: number;", "scope": "AnalysisFinding", "scopeKind": "interface", "description": "unavailable"}, {"name": "recommendation: string;", "scope": "AnalysisFinding", "scopeKind": "interface", "description": "unavailable"}, {"name": "rule: string;", "scope": "AnalysisFinding", "scopeKind": "interface", "description": "unavailable"}, {"name": "severity: Severity;", "scope": "AnalysisFinding", "scopeKind": "interface", "description": "unavailable"}, {"name": "summary: AnalysisSummary;", "scope": "AnalysisResponse", "scopeKind": "interface", "description": "unavailable"}, {"name": "title: string;", "scope": "AnalysisFinding", "scopeKind": "interface", "description": "unavailable"}, {"name": "total: number;", "scope": "AnalysisSummary", "scopeKind": "interface", "description": "unavailable"}]}